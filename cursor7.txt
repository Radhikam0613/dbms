-- Products table
DROP TABLE Products PURGE;
CREATE TABLE Products (
  Product_ID NUMBER PRIMARY KEY,
  Product_Name VARCHAR2(100),
  Product_Type VARCHAR2(50),
  Price NUMBER(10,2)
);

-- sample data
INSERT INTO Products VALUES (1, 'T-Shirt', 'Apparel', 750);
INSERT INTO Products VALUES (2, 'Laptop', 'Electronics', 65000);
INSERT INTO Products VALUES (3, 'Jacket', 'Apparel', 2300);
COMMIT;

-- 1. parameterized cursor (Apparel between min and max)
DECLARE
  CURSOR c1(minp NUMBER, maxp NUMBER) IS
    SELECT Product_ID, Product_Name, Price FROM Products
    WHERE Price BETWEEN minp AND maxp AND Product_Type = 'Apparel';
  r PRODUCTS%ROWTYPE;
BEGIN
  OPEN c1(500, 3000);
  LOOP
    FETCH c1 INTO r;
    EXIT WHEN c1%NOTFOUND;
    DBMS_OUTPUT.PUT_LINE('Apparel: '||r.Product_Name||' Price: '||r.Price);
  END LOOP;
  CLOSE c1;
END;
/

-- 2. explicit cursor price > 5000
DECLARE
  CURSOR c2 IS SELECT Product_ID, Product_Name, Price FROM Products WHERE Price > 5000;
  r PRODUCTS%ROWTYPE;
BEGIN
  OPEN c2;
  LOOP FETCH c2 INTO r; EXIT WHEN c2%NOTFOUND;
    DBMS_OUTPUT.PUT_LINE('Expensive: '||r.Product_Name||' Price: '||r.Price);
  END LOOP;
  CLOSE c2;
END;
/

-- 3. implicit cursor for update statement
BEGIN
  UPDATE Products SET Price = Price + 100 WHERE Product_Type = 'Apparel';
  DBMS_OUTPUT.PUT_LINE('Rows updated: ' || SQL%ROWCOUNT);
  ROLLBACK; -- rollback so sample data not permanently changed here
END;
/
