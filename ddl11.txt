USE corp_db;

-- Branch table
DROP TABLE IF EXISTS Branch;
CREATE TABLE Branch (
  BranchID INT PRIMARY KEY AUTO_INCREMENT,
  Branch_Name VARCHAR(100),
  Address VARCHAR(200)
);

-- Customer table
DROP TABLE IF EXISTS Customer;
CREATE TABLE Customer (
  CustID INT PRIMARY KEY AUTO_INCREMENT,
  Name VARCHAR(100),
  Cust_Address VARCHAR(200),
  Phone_no VARCHAR(20),
  Email_ID VARCHAR(100),
  Age INT
);

-- Account table (FKs)
DROP TABLE IF EXISTS Account;
CREATE TABLE Account (
  Account_no INT PRIMARY KEY AUTO_INCREMENT,
  BranchID INT,
  CustID INT,
  date_open DATE,
  Account_type VARCHAR(50),
  Balance DECIMAL(12,2),
  FOREIGN KEY (BranchID) REFERENCES Branch(BranchID),
  FOREIGN KEY (CustID) REFERENCES Customer(CustID)
);

-- Sample data
INSERT INTO Branch(Branch_Name, Address) VALUES ('Main Branch','Pune');
INSERT INTO Customer(Name, Cust_Address, Phone_no, Email_ID, Age) VALUES ('Sonal','Pune','9999999999','sonal@example.com',28);
INSERT INTO Account(BranchID, CustID, date_open, Account_type, Balance) VALUES (1,1,'2018-08-16','Saving Account',35000);

-- Index (explicit)
CREATE INDEX idx_account_balance ON Account(Balance);

-- View customers age < 45
DROP VIEW IF EXISTS Customer_Info;
CREATE VIEW Customer_Info AS SELECT * FROM Customer WHERE Age < 45;

-- Example update using view (updatable view)
UPDATE Customer_Info SET Cust_Address='Pune, India' WHERE CustID=1;

UPDATE Account
SET date_open = '2017-04-16'
WHERE CustID IN (SELECT CustID FROM Customer WHERE Age < 45);

-- Oracle/Postgres syntax (not MySQL 5.x)
CREATE SEQUENCE branch_seq START WITH 1 INCREMENT BY 1;

CREATE SYNONYM Branch_info FOR Branch;
